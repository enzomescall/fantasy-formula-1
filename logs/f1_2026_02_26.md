# F1 Fantasy Log — 2026-02-26

## What we did today
- Implemented the automation plan scaffolding for 2026:
  - Added `fantasy-formula-1/scripts/f1_2026_sync_team.py` (Playwright-based team sync).
  - Added `fantasy-formula-1/requirements.txt` (Playwright dependency).
  - Added `fantasy-formula-1/ideal_team.json` (current ideal lineup + boost).
  - Created state folders: `fantasy-formula-1/state/`, `state/history/`, `state/artifacts/`.
  - Updated `fantasy-formula-1/PLAN_2026_AUTOMATION.md` to use JSON snapshot + history archive.
- Ran dependency install steps on host:
  - `python3.12 -m pip install -r fantasy-formula-1/requirements.txt`
  - `python3.12 -m playwright install chromium`
  - Note: python3.6 pip cannot install Playwright; must use python3.12 on this host.
- Cookie/session reuse:
  - Identified OpenClaw Chromium cookies DB at `~/.openclaw/browser/openclaw/user-data/Default/Cookies`.
  - Copied OpenClaw Chromium `user-data/` into `fantasy-formula-1/.playwright-profile/` so Playwright can run headless without interactive login.
- Script hardening:
  - Updated scraping/click scoping using CSS-off DOM insights:
    - selected lineup lives under `div.si-formation__container`
    - remove buttons are icon buttons in `div.si-player__card-cta` (contains `i.f1i-close`)
  - Fixed utc timestamp generation to avoid `datetime.utcnow()` deprecation warnings.
  - Added guardrails: if an available-list add button is disabled (has `disabled` attribute OR includes class `si-disabled`), treat it as a budget/unavailable constraint and abort with an artifact screenshot.
- Selector updates from Enzo CSS-off inspection:
  - Selected lineup container: `div.si-formation__container`
  - Remove button: `div.si-player__card-cta button.si-btn__primary-light` (contains `i.f1i-close`)
  - Available-list add button: `button.si-btn__primary-dark` (contains `i.f1i-add`)
- Validation: successfully executed a partial-diff driver swap headless (Leclerc -> Stroll) and then reverted back (Stroll -> Leclerc) using Playwright + copied OpenClaw cookies/profile.
- Constructors WIP: attempted constructor swap test (Ferrari -> Mercedes). Manual headless Playwright test shows it *should* work after removal (button becomes enabled); script still needs additional waiting/verification to avoid trying while disabled.
- Current state per Enzo request: Pascal GP 1 has Stroll instead of Leclerc (kept Stroll).
- 2026-02-25: Swapped constructors to McLaren + Mercedes and persisted via Continue → Confirm Changes; screenshot captured.
- Enzo confirmed account has **Pascal GP 1/2/3**; treat **Pascal GP 1** as main.
- Verified we can open **Manage Team** for **Pascal GP 1** reliably by:
  - navigating from /en/my-team, clicking the **Manage Team** button within the Pascal GP 1 card
  - landing at URL **/en/my-team/1**
  - confirming page text contains **"Pascal GP 1"** and does **not** contain strings **"Pascal GP 2"** or **"Pascal GP 3"** after the click.

## Screenshot sequence test: remove + re-add drivers via full list (NOT the empty-slot “Add Driver” buttons)
Context: performed on **Pascal GP 1** at URL `/en/my-team/1`.

0) Start state: Pascal GP 1 open.
1) Confirmed Drivers tab.
2) Removed driver: Leclerc (clicked X on Leclerc card in the selected-drivers area).
3) Removed driver: Bottas.
4) Removed driver: Lawson.
5) Removed driver: Bortoleto.
6) Removed driver: Colapinto. (All 5 driver slots empty; “Add Driver” (+) slots appeared but were ignored.)
7) Added driver via the *full driver list* below: Leclerc (clicked his row/card in the list; did not click empty-slot add).
8) Added driver via list: Bottas.
9) Added driver via list: Lawson.
10) Added driver via list: Colapinto.
11) Added driver via list: Bortoleto. (Drivers re-added in a different order than original.)
12) Set 2x boost to Bortoleto:
    - initial boosted driver was Leclerc (detected via page text “2x C.LECLERC”)
    - opened Bortoleto driver details, clicked “Add Boost”; verified “2x G.BORTOLETO”.
13) Clicked “Done” to save changes; team view still showed 2x badge on Bortoleto.

## Confirm flow (important): Continue → Confirm Changes
Observed that "Done" alone may not persist changes. The reliable persistence path is:
- Click **Continue** (once team is valid)
- A **Team Changes** modal appears with a Summary and a **Confirm Changes** button
- Click **Confirm Changes** to persist and return to /en/my-team

## Screenshot sequence run #2 (end-to-end persist)
Performed on Pascal GP 1 (/en/my-team/1), after Enzo modified the team.

Pre-state observed at start of run #2:
- Pascal GP 1 contained drivers: Bearman, Stroll, Alonso, Albon, Perez.
- A 2x badge was present on Albon.

A1) Removed all 5 drivers using the X buttons on each selected driver card.
    - Took and sent an "empty team" screenshot (only + Add Driver placeholders visible).
A2) Added the script-optimal 5 drivers *via the full driver list* (not via empty-slot buttons):
    - Charles Leclerc
    - Valtteri Bottas
    - Liam Lawson
    - Gabriel Bortoleto
    - Franco Colapinto
    - Took and sent a screenshot after all 5 were added.
A3) Set 2x boost to Bortoleto:
    - Opened Bortoleto driver details and clicked "Add Boost".
    - Verified boosted driver via page text matcher: "2x G.BORTOLETO".
    - Took and sent a screenshot showing the 2x badge on Bortoleto.
A4) Clicked **Continue** → Team Changes modal appeared.
    - Took and sent a screenshot of the modal (shows Summary and "Confirm Changes").
A5) Clicked **Confirm Changes**.
    - Returned to /en/my-team (Fantasy home list of teams).
    - Took and sent a screenshot showing Pascal GP 1 with the rebuilt lineup and 2x on Bortoleto.
- Created the local project directory: `fantasy-formula-1/`
- Added `fantasy-formula-1/SKILL.md` with goals + operating notes.
- Opened the F1 Fantasy site in the headless `openclaw` browser profile.
  - Confirmed we were **not logged in** (menu showed **SIGN IN** / **REGISTER**).
  - Dismissed cookie consent (rejected non-essential cookies).
- Navigated to the F1 account login page: https://account.formula1.com/#/en/login
- Took and sent a screenshot **before** attempting login.
- Attempted to sign in with pascal.ai.inbox@gmail.com + the provided one-time password.
  - Result: **login failed** with message: "There was a problem with your password or email address. Please check your details and try again."
- Retried with corrected password `[REDACTED]`:
  - Prompted to verify email; pulled verification link from inbox and verified successfully.
  - Completed profile: Country=Brazil; Favourite Team=Ferrari; Favourite Driver=Charles Leclerc; accepted T&Cs.
  - Built team under $100.0M: Drivers = Leclerc, Bottas, Lawson, Bortoleto, Colapinto; Constructors = McLaren, Ferrari.
  - Set Boost/x2 driver = Leclerc.
  - Named team: "Pascal GP".
  - On saving, an interstitial "You're all set!" screen appeared; a follow-up attempt to "Save as new Team" returned "Something went wrong." (unclear whether the initial save persisted).
- Later update (Enzo checked in logged-in session): account now has **three teams** named: **Pascal GP 1**, **Pascal GP 2**, **Pascal GP 3**.
  - Treat **Pascal GP 1** as the **main team**; ignore the other two.

## Goal
- Log in to https://fantasy.formula1.com/ with **pascal.ai.inbox@gmail.com** and create a team.

## Next steps
- Attempt sign-in via the site’s **SIGN IN** button.
  - Landed on the F1 Account login page: https://account.formula1.com/#/en/login
  - This flow requires **email + password** (not Google OAuth).
- Decide login method:
  1) Enzo logs in via a connected Chrome tab (Browser Relay), or
  2) Enzo provides credentials (not recommended over chat), or
  3) Use password reset flow + Enzo provides the one-time link/code.
- Once authenticated, create a team and record:
  - team name
  - chosen drivers + constructors
  - remaining budget
  - any league joined
